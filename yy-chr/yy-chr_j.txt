--------------------------------------
  YY-CHR   beta 0.98-02  by わいわい
--------------------------------------

■概要
  家庭用ゲームの汎用グラフィックエディタです。
  多機種の標準画像形式に対応していて、並べ替え表示や、基本的な描画機能、
  エミュレータのセーブデータからパレットを読み込む等の機能があります。
  ※ゲーム機の非標準形式(圧縮された画像など)には対応していません。


■動作環境
  YY-CHRを快適に動かすには以下の環境が必要です。

  OS  : Windows 95 / 98 / 2000 で動作確認済み。
	Windows Me / NT でも動くとの報告があります。
  CPU : Pentium 150MHz
	快適ではありませんがこれ以下のCPUでも動きます。

	Windows95で古いDLLを使っていると起動できないことがありますが、
	comctl32.dllを最新版にすることで解決したという報告があります。
	最新版のcomctl32.dllは下のURLから手に入れることができます。
	http://www.microsoft.com/japan/legal/permission/copyrgt/cop-soft3.htm

	起動しないけど最新版のcomctl32.dllも入れたくない場合は、
	Ctrlを押しながら起動することで起動できるかもしれません。
	ただし、この時ツールバーの一部のボタンは表示されません。
	この状態で設定を保存すると以後、Ctrlを押さなくても起動できます。


■インストール・アンインストール
  適当なフォルダに解凍するとそのまま使う事ができ、
  削除するだけできれいにアンインストールできます。
  設定はyy-chr.cfgに記録し、レジストリは使っていません。

  動作に必要な最小のファイルは、以下の3つのファイルです。
	yy-chr.exe
	g_kit.dll
	srexhsp.dll


■特別な操作法の説明
ショートカットキーはメニューを参照してください。

左クリック
	左の画面 : 通常選択。右の画面に編集対象範囲を表示します。
	右の画面 : 描画。エディトボタンの方法で描画します。
		   直接描画(ペン)以外の時は、右クリックでキャンセルできます。
	DATパレット : 描画色の選択
	NESパレット : DATパレットに使う色を選択
	アドレスバー : アドレスを変更
	ボタン : ボタンの選択

右クリック
	左の画面 : 範囲選択。コピー・貼り付けなどの範囲を選択します。
	右の画面 : スポイト。ポインタ位置の色を取得します。
	NESパレット : パレットのRGB値の変更


F5	: 上書保存
F6	: 名前を付けて保存
F7	: 再読込み
F8	: ファイルを開く
F9	: 編集中のバンクをBMPファイルに書き出します (chrXXX.bmp)
F11	: パレットやADFファイルを再読込みします
F12	: エミュレータのセーブデータからパレットを読み込みます

※リストボックスなどを非選択時
Home	: アドレスをCHRの最初に
End	: アドレスをCHRの最後に
PgUp	: アドレスを-$1000 (1画面↑)
PgDn	: アドレスを+$1000 (1画面↓)
↑	: アドレスを-$0100 (1ライン↑)
↓	: アドレスを+$0100 (1ライン↓)
←	: アドレスを-$0010
→	: アドレスを+$0010
-	: アドレスを-$0001
+	: アドレスを+$0001

// Z,X,C,V : パレット0,1,2,3を選択

Ctrl+↑ : 上下反転
Ctrl+↓ : 左右反転
Ctrl+← : 左回転
Ctrl+→ : 右回転

Shift+カーソル : カーソルの方向へシフト

Shift+描画 : 閉領域ペイント

Shift+1〜5 : グリッドカラーなどの変更

Shift+(貼り付け動作) : BMP貼り付け／クリップボードの処理で減色をする


■仕様とか注意とか
・起動時に yy-chr.pal, yy-chr.dat, yy-chr.adf, yy-chr.chr, yy-chr.nes 
  がある時は自動的に開き、yy-chr.hlp がある時はヘルプとして使うことができます。
・ファイルを開いた時にfilename.* (pal, dat, adf) がある時は勝手に読み込みます。
  ※ただし画像としてdatファイルを開いた時はdatファイルは読み込みません。

・設定を保存すると yy-chr.cfg が作成されます。
  初期状態に戻すにはこのファイルを削除してください。
  保存される項目は現在は、チェックボックス、倍率、グリッドの色、ペンの種類です。
  設定ファイルをいじると一部のレイアウトを変更することができます。

・ROMを開いた時に拡張子で形式を自動選択します。
  どの形式にも対応しない拡張子の場合は1bppで開きます。
  対応拡張子
	2bpp NES           nes,fds,chr
	2bpp GB            gb,gbc
	2bpp NGP           ngp
	2bpp VB            vb
	4bpp SNES          smc,fig
	4bpp SMS/GG/WSC    sms,gg
	4bpp MSX(/MD)      rom,smd,bin
	4bpp GBA           gba

・以下のエミュレータのセーブデータからパレットを読み込むことができます。
  Nesticle, Famtasia, VirtuaNES, LoopyNES, G-NES, nester, RockNES, ZSNES, 

・[Paste]は選択されている左上の位置から[Copy]されたサイズだけ貼り付けます。
  128x128を超えるサイズは正しく貼り付けることはできません。

・パレットファイル(.pal)は、256色までのパレットが使えますが、
  同時に使える色は連続した64色で、それ以上は切り替えて使います。

・パレットファイルやRGBエディトで指定した色がシステムカラーが同じ色の時、
  システムカラーが優先され、パレットで指定した色値がずれることがあります。

・Grid line をチェックするとグリッドを表示します。
・Menu popupをチェックすると範囲選択時にメニューがポップアップします。

・256色環境でも動きますが、16bitカラー以上の環境での使用をお勧めします。

・UNDOバッファサイズは一回16KB。UNDO可能回数はデフォルトで16回(256KB)。
  yy-chr.cfg(0x0099)を弄った最小値は1回、最大は255回(4MB)。


■予定
難 設定ダイアログを作る
難 描画処理全体を書き直す
難 パレットの処理を汎用的なものに書き直す。
難 Shift+右ドラッグで1ドット単位の範囲指定(無理かも)、
難 減色(同色・類似色の統合に対応予定。未使用色削除は対応済)
難 ドロップでADF/DAT/PAL/COL/PS/SaveStateを開けるようになったらいいな。

■判明している問題
クリップボード中の横サイズが4で割れない画像を貼り付けると画像が崩れることがある。
大きい画像(128x128以上)を貼り付けた時、WinAPIに任せた結果とG-Kit.dllで処理した結果が違う。
ADFで重複したBGは、最後に指定したところしか編集できない。(g-kit.dll)
バグではないけど、UNDOはパレットセットには反映されない(修正予定なし)


■主な更新履歴
yy-chr.cfgファイルのバージョンがあがった時は、変更された設定項目や
追加された設定項目は読み込まれません。設定を保存しなおしてください。

ver0.98β
02 設定ファイルがないときに設定の保存でエラーが出ていたのを修正
01 バージョン情報でWindows9X用のリソース表示処理を削除
   アドレス指定の処理を追加(ボタンはまだ無効です)
00 開くダイアログで先頭の拡張子しか表示対象になっていなかったことを修正。
   VirtuaNESのセーブステート読み込み修正(StateVer2仮対応)

ver0.97β
25-31 ソース行方不明になるorz

23 G-Kit.dllに 1BPP 16x16 の更新処理を追加してみた
22 G-Kit.dllに 1BPP 16x16 の表示処理を追加してみた
21 G-Kit.dll修正。1辺が小さな楕円の処理を変更。
20 G-Kit.dllに直線、矩形、楕円、閉領域ペイント、点描画の機能をつけた。
   * WindowsのAPIを使わない処理です。楕円はWinAPIの結果と多少異なります。
     WindowsのAPIを使いたいなら"Use old API"にチェックしてみてください。
   新規作成画像の編集時にドロップしたファイルを開けないバグを修正。
10 同色のパレットが複数ある時、ペン以外の描画機能が異常だったのを修正。
   ペン以外の描画でもパレットセット(COL/PS)を更新できるようにした。
   [描画でパレットセットを変更しない]のチェックボックスはPSの時は無視される。
07 最大UNDO回数をyy-chr.cfg(0x0099)で指定できるようにした。
06 ファイル保存(拡張子追加など)の修正。
05 G-Kit.dllの仕様変更・修正。起動処理を修正。
03 パレットの初期化、グリッドの描画処理を改善。

ver0.90〜0.96β
85 メインパネルへのドラッグアンドドロップに対応。
   Shiftを押しながらドロップで新しいウィンドウで開くようにした。
   ドロップで開いた後にアクティブになるようにした。
   パレット番号やDUMP(DUMPは現在非対応)のフォントを変更。
   なんとなくハーフトーンを復活させてみた(4つ並んだチェックボックスの2番目)
75 たぶん高速化。
   パレットテーブル・背景をDLLで描画するようにした。
   画像バッファのコピーをDLLで処理するようにした。
72 アドレスの説明を出すようにした。
   パレットを変える処理を速くした…たぶん。
   重複したパレットの処理を修正。
   色の置き換え後、特定の操作で落ちていたのを修正。
68 BMP読み込み／クリップボードから貼り付けのときにShiftを押しっぱなし
   にすると、減色(未使用色の削除)をしてから貼り付けるようにした。
   ペンでセットを変更しないオプションを追加。
66 BGエディト関連の機能を外した。ソースから旧COL処理を完全に削除した。
   Z,X,C,Vのキーでパレット0,1,2,3を選択するのを外した。
   パレットにFFをセット(キャラ無しに)した時、ペン描画で表示がおかしくなるのを修正。
   リロード時のPSリストの処理を修正。
65 パレットのRGBエディトを修正。パレット精度を指定できるようにした。
   試験的に付けたコマンドラインのパラメータ/Aと/Fをはずした。
   リロード時のADFリストやアドレスの処理を修正。
   COLファイルの仕様を変更した(今までのCOLファイルは使えません)
   Ctrl+M(COLの新規作成)後、ROMを保存するまでCOLを作成しないようにした。
64 領域選択のグリッドの色を追加。その設定の保存も修正。(ConfigVer02)
63 試験的にコマンドラインにオプションを追加。
   /A:XXXXXX で指定アドレスXXXXXXで開けます。
   /F:X ( 0=1BPP, 1=2BPP NES, 2=2BPP GB... )で指定形式で開けます。
   コマンドラインや関連付けで""を使うと起動できてなかったのを修正。
62 バージョン違いの設定ファイルを読んだ時の処理を改善。(ConfigVer01)
   試験的に四角形や楕円の範囲を表示するオプションを追加。
61 グリッドカラーなどのエディト機能を変更(RGBエディトにした)
   Shift+1〜4でRGBバーが出ます。
60 一部処理の最適化。色の置き換えをマウス対応にした。
59 パレットエディタを外して右クリックからのRGBエディトだけにした。
58 パレットエディタをつけた。
57 一時的にパレットで右クリックするとRGB編集できるようにした。
56 起動できない環境用の処理を追加した。細かいバグの修正。
55 4BPPで色の入れ替えができてなかったのを修正。
   バージョン表示ダイアログでリソースを出すようにした（ありがちだけど
   エミュレータのデータを開くツールボタンをカシオンさんの描いた物を参考にした。
54 セーブデータ読み込み後に色の入れ替えで落ちるバグを修正。
   一部処理の最適化。
53 ツールバーに色の置き換えを追加。色の置き換えに関するバグを修正。
   色の置き換えを2BPP以外にも対応させた。
   起動直後のCtrl+Aの表示がおかしかったのを修正。
52 ツールバーに編集メニューからいろいろ追加。
   ※ツールバーがバグったら報告をお願いします。
     特にMe/NT/2000/XPは動作確認ができないので。
51 レイアウトの変更で座標がマイナスに行かないようにした。
50 ADF/COL/PSの処理を書き直した。
   PSファイルのパレットセット・BGエディトができるようになった。
   $FF(非描画)のパレットセットはCOL-SETでしかエディトできないようにしてます。
   右ドラッグの範囲選択を右下から左上方向にできるようにした。
44 PS使用後にCOLを使用するとADF欄が変更されないのを修正。
43 BGエディトの時のDUMP、ハーフトーンを付けてみた。その他。
42 グリッドの色を追加・変更。
41 メニューが一部おかしかったのを修正(スナップがF12とか)
40 Ctrl+1〜5を押しながらカーソルキーでレイアウトの変更をできるようにした。
   $2000バイト未満の小さいファイルを保存すると$2000バイトになるバグを修正。
   タイトルバーにもファイルサイズを表示するようにした。
   クリップボードが空でも貼り付け時にUNDOを作成していたのを修正。
   EXEのサイズを40KBくらい小さくした。
38 設定を保存できるようにした。作成されるファイルは yy-chr.cfg で、
   保存される項目は、チェックボックス、倍率、グリッドの色、ペンの種類です。
   BGエディトをQからCtrl+Qに変更。
37 (G-Kit.dll)マウス処理の高速化。市松処理を高速化。
36 アドレスを変更した時のUNDOの処理が間違っていたのを修正。バグがあったら報告キボン。
35 ペンの補間機能を追加(デフォでON)。遅すぎるPCでは外したほうがいいかも…
34 色の置き換えに(実験的に)対応。Ctrl+Rで操作画面が出ます。
33 マウスの処理を修正。機能の説明を出すようにした。CHR変更。
32 クリップボード中の1bitDIBの貼り付けの対応を外しています。
   ツールバーのUNDO/REDOボタンを右端に表示するようにした。
   (G-Kit.dll)4bpp MSX、4bpp GBAの処理が間違ってたので修正。
31 回転処理が速くなったかもしれない。背景とボタンの描画処理を修正。
30 マウス位置の状態表示を追加。F11キーのバグ修正。
   円の描画を「中心指定＋半径」から「選択範囲に内接する楕円」に変更。
   描画時の座標指定とキャンセルの挙動を修正。
   Shift＋クリックで閉領域のペイントにした。市松ペンを追加。
28 ADF編集時にパレットを変更するとDUMPの色が一瞬化けるのを修正。
   .ps使用時に不正終了してたのを修正。
27 ADF編集機能を追加。QキーでADF編集モード切り替え。
   メニューにADF保存項目を追加。Enterキーをリストボックスの決定にした。
26 ADF使用時にパレットクリックでパレットをセットできなかったのを修正。
   colファイルの対応を強化・バグ修正。
25 col使用時かつ範囲選択時にパレットクリックでパレットをセットするようにした。
24 F12キーの割り当てをはずし、F10キーの機能をF12キーに変えた。
   UNDO処理を書き直した。リロード時にUNDOができるバグを修正。
   最大UNDO回数を16にしてみた。col使用時のUNDOを修正した。
   ペン描画の処理を改善した。
23 関連付け起動時のカレントディレクトリをファイルのディレクトリに変更した。
   左のグリッドに対応(見栄えが悪いが…)
22 VirtuaNES 0.2X / 0.3X のステートデータに対応。
21 新規作成、ヘッダ読み込み、パレット等の処理を修正。
20 キーボードの反応が改善された。
13 アドレス変更のボタンを付けた。
12 パレット関連の保存(dat, pal)ができるようになった(palは自由には変更できないけど)
   選択範囲の切り取り・削除後の色を0番パレットにした。
   VirtuaNES 0.24のステートデータ読み込みに対応？バグ修正。
11 グリッドの色変更など。
10 Exforce.dllの代わりにSrexhsp.dllを使うようにした。
08 .psファイルに対応。
05 ADF並べ替え時にcolの処理を間違えてたのを修正。
   (一時的に)Ctrl+Mでcolファイルを作成できるようにした。
   col使用時のみ"セット変更ペン"を使えるようにした。
04 2bpp NESにパレットセット(.col)関連の処理を追加。
03 ver.0.80からメニューの処理を間違ってたのを修正。軽くなったかも？
02 Redoできるようにした。
01 小さすぎる/大きすぎるファイルで起こるバグを修正。カーソルのずれを修正。
00 不安定だったのを修正


■謝辞
  内蔵のNESパレットにカシオンさんが作成したものを使っています。
  一部の機能拡張にさくらさんの"Srexhsp.dll"を使っています。
  ハイレベルチャレンジでアドバイスをしてくれた人ありがとふ。


	わいわい ( geo-yy@geocities.co.jp )
	http://www.briansemu.com/yymarioed/
